---
title: "Exploratory Data Analysis"
author: "Taylor Bonar, Alexandre Jasserme & Halle Purdom"
date: "5/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Function to investigate missing values in a column
investigate_missing_column_values <- function(column_name) {
  missing_indices <- which(is.na(life_expectancy[,column_name]))
  print(length(missing_indices))

  # Are any specific year a key indicator of missing value?
  print(life_expectancy[missing_indices,] %>% 
    group_by(Year) %>%
    summarise(missing = length(Year)))

  # What about country?
  print(life_expectancy[missing_indices,] %>% 
  group_by(Country) %>%
  summarise(missing = length(Country)))

}

# Function to investigate over 1,000 values (for infant deaths and under 5 deaths)
investigate_over1000 <- function(column_name) {
  indices1000 <- which(life_expectancy[,column_name]>1000)
  print(length(indices1000))

  # Are any specific year a key indicator of missing value?
  print(life_expectancy[indices1000,] %>% 
    group_by(Year) %>%
    summarise(missing = length(Year)))

  # What about country?
  print(life_expectancy[indices1000,] %>% 
  group_by(Country) %>%
  summarise(missing = length(Country)))

}

# Function to investigate over 200 values (for infant deaths and under 5 deaths)
investigate_over200 <- function(column_name) {
  indices200 <- which(life_expectancy[,column_name]>200)
  print(length(indices200))

  # Are any specific year a key indicator of missing value?
  print(life_expectancy[indices200,] %>% 
    group_by(Year) %>%
    summarise(missing = length(Year)))

  # What about country?
  print(life_expectancy[indices200,] %>% 
  group_by(Country) %>%
  summarise(missing = length(Country)))

}


# Libraries to load
library(plyr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(GGally)
library(wbstats)
library(data.table)

# Set current working directory as git repository local folder
setwd(".")

# Retrieve current dataset
life_expectancy = read.csv("Life Expectancy Data.csv", header = TRUE, fileEncoding = "UTF-8")
```

```{r}
life_expectancy <- life_expectancy %>%  rename('LifeExpectancy'='Life.expectancy',
                                               'AdultMortality'='Adult.Mortality',
                                               'InfantDeaths'='infant.deaths',
                                               'PercentageExpenditure'='percentage.expenditure',
                                               'HepatitisB'='Hepatitis.B',
                                               'UnderFiveDeaths'='under.five.deaths',
                                               'TotalExpenditure'='Total.expenditure',
                                               'HIV_AIDS'='HIV.AIDS',
                                               'Thinness_1_19_years' = 'thinness..1.19.years',
                                               'Thinness_5_9_years' = 'thinness.5.9.years',
                                               'IncomeCompositionOfResources' = 'Income.composition.of.resources')

summary(life_expectancy)
sum(complete.cases(life_expectancy))
sum(!complete.cases(life_expectancy))
```

# Comments on each column
Description taken from one of the following:
- https://www.kaggle.com/kumarajarshi/life-expectancy-who: Data Explorer -> Column
- https://www.who.int/data/gho/data/indicators/indicators-index (and will be marked from )

## Country
```{r Country as Factor}
# Check for unique countries to match expectation and transform into factor class for later analysis, should be 193 countries
life_expectancy %>% 
  group_by(Country) %>%
  summarise(count = length(Country))
# Check for any countries that do not have 16 rows/year of data (hint hint Tuvalu, and some others)

# What year do they have?


# Transform into factor for easier analysis
life_expectancy[,'Country'] <- factor(life_expectancy[,'Country'])
unique(life_expectancy[,"Country"])

investigate_missing_column_values("Country")

# We will remove any countries for which we don't have 16 years of data: Cook Islands, Dominica, Marshall Islands, Monaco, Nauru, Niue, Palau, Saint Kitts and Nevis, San Marino, Tuvalu	
life_expectancy <- life_expectancy [((life_expectancy$Country != "Cook Islands") &
                                       (life_expectancy$Country != "Dominica") &
                                       (life_expectancy$Country != "Marshall Islands") &
                                       (life_expectancy$Country != "Monaco") &
                                       (life_expectancy$Country != "Nauru") &
                                       (life_expectancy$Country != "Niue") &
                                       (life_expectancy$Country != "Palau") &
                                       (life_expectancy$Country != "Saint Kitts and Nevis") &
                                       (life_expectancy$Country != "San Marino") &
                                       (life_expectancy$Country != "Tuvalu")),]


# South Sudan gained independence from the Republic of the Sudan in 2011 (https://en.wikipedia.org/wiki/South_Sudan). Sudan is already in our dataset so the data about South Sudan prior to 2011 is questionable and we will remove South Sudan from the data set
life_expectancy <- life_expectancy [(life_expectancy$Country != "South Sudan"),]

nrow(life_expectancy)
# 10 countries with only 1 year of data were removed; 1 country was completely removed and the data frame went from 2938 to 2912 rows, so a difference of 26 rows, which makes sense: 10*1 + 16 = 26
```

## Year
```{r Year as Factor}
# Transform Years into factor
life_expectancy[,'Year'] <- factor(life_expectancy[,'Year'])
unique(life_expectancy[,"Year"])

# Filtering 2013 to 2015: 
# - Both 2013 and 2015 have a significant number of missing values
# - 2014 is also removed so that we only have consecutive years in the dataframe
life_expectancy <- life_expectancy [((life_expectancy$Year != 2013) &
                                       (life_expectancy$Year != 2014) &
                                       (life_expectancy$Year != 2015)),]

nrow(life_expectancy)
# 3 years were removed and with 182 countries left, the dataframe went from 2912 to 2366 rows, so a difference of 546 rows, which makes sense: 182*3 = 546
```

## Status
Some of the data in this column has been changed:
- It's not clear what is the cutline between a Developed and a Developing country
- In the original data, the following countries were marked as Developed: Hungary, Italy, Latvia, Lithuania, Poland, Spain, Portugal
- Based on this and the GDP per capita (from https://api.worldbank.org/v2/en/indicator/NY.GDP.PCAP.PP.CD?downloadformat=csv, using data from 2015), the Status for the following countries will be changed from Developing to Developed: Bahamas, Bahrain, Canada, Finland, France, Greece, Israel, Monaco, Qatar, Republic of Korea, San Marino, Saudi Arabia, United Arab Emirates - note that we already removed Monaco and San Marino from the dataset based on having data for only 1 year

```{r}
print(paste0("Before change: number of rows with Developed: ", sum(life_expectancy$Status == "Developed")))
print(paste0("Before change: number of rows with Developing: ", sum(life_expectancy$Status == "Developing")))
life_expectancy$Status <- ifelse(life_expectancy$Country %in% c('Bahamas', 'Bahrain', 'Canada', 'Finland', 'France', 'Greece', 'Israel', 'Monaco', 'Qatar', 'Republic of Korea', 'San Marino', 'Saudi Arabia', 'United Arab Emirates'), "Developed", life_expectancy$Status)
print(paste0("After change: number of rows with Developed: ", sum(life_expectancy$Status == "Developed")))
print(paste0("After change: number of rows with Developing: ", sum(life_expectancy$Status == "Developing")))

life_expectancy[,'Status'] <- factor(life_expectancy[,'Status'])
```
After the change, the number of rows with Developed increased by 559-416=143 (with a corresponding decrease for the rows with Developing), which makes sense because the Status was updated for 11 countries (since Monaco and San Marino are no longer part of the dataset) and we have 13 rows left for all remaining countries (for years 2000 to 2012): 11*13 = 143


## Life expectancy
Description (from WHO): This seems to be "Life expectancy at birth (years)" (the other option "Life expectancy at age 60 (years)" is not consistent with the data)
Missing Values: 10 out of entire dataset, after range restriction no missing values remain
```{r}
investigate_missing_column_values("LifeExpectancy")
```


## Adult Mortality
Description: Adult Mortality Rates of both sexes (probability of dying between 15 and 60 years per 1000 population)
Missing Values: 10 out of entire dataset, after range restriction no missing values remain
```{r}
investigate_missing_column_values("AdultMortality")
```


## infant deaths
Description: Number of Infant Deaths per 1000 population
The maximum of 1800.0 seems to be inaccurate (India 2000-2012)
```{r}
summary(life_expectancy$InfantDeaths)

investigate_over1000("InfantDeaths")

#India 2000-2012 https://data.worldbank.org/indicator/SP.DYN.IMRT.IN 

life_expectancy %>% ggplot(aes(x=life_expectancy$InfantDeaths))+geom_histogram()
investigate_over200("InfantDeaths")

#Bangladesh- incorrect
#China- incorrect
#Democratic Republic of Congo- incorrect
#Ethiopia- incorrect
#Nigeria- incorrect
#Pakistan- incorrect

###DATA PREP: Merge Function for missing/incorrect data
# Fill incorrect InfantDeaths data from secondary source: World Banks -- indicator code:  SP.DYN.IMRT.IN 
wb_infant <- wb_data(indicator = "SP.DYN.IMRT.IN", country = "countries_only", start_date = 2000, end_date = 2015)
# Grab only necessary columns and map to match dataset

# Commenting code that's causing an error:
# Error: Can't subset columns that don't exist.
# x Column `SH.DYN.MORT` doesn't exist.

# wb_infant <- wb_infant %>% select(date, SH.DYN.MORT , country)
# colnames(wb_infant) = c("Year", "InfantDeaths", "Country")
```


## Alcohol
Description: Alcohol, recorded per capita (15+) consumption (in liters of pure alcohol)
Missing values: only 1 value is missing for Montenegro in 2005; the value for 2004 is 0.01 and the value for 2006 is 5.38 so we will just leave the cell blank instead of trying to average the previous and following year.
Data accuracy: The data seems to make sense for the most part (reasonable min and max, low consumption in mainly Muslim countries, for example); there are some exceptions, see for example the comment above for Montenegro

```{r}
investigate_missing_column_values("Alcohol")
```

## percentage expenditure
Description: Expenditure on health as a percentage of Gross Domestic Product per capita(%)
A lot of problem in this column, for example:
- Min.: 0.000  
- Max.: 19479.912

## Hepatitis B
Description: Hepatitis B (HepB) immunization coverage among 1-year-olds (%)
500 N/A (out of almost 3,000 observations)
-> We have fewer than 80% of the value so consider dropping this column

```{r}
investigate_missing_column_values("HepatitisB")
```

## Measles
Measles - number of reported cases per 1000 population
A lot of problem in this column, for example:
- Max.: 212183.0

```{r}
investigate_missing_column_values("Measles")
```

## BMI
From WHO: It is defined as a person's weight in kilograms divided by the square of his height in meters (kg/m2). The WHO definition is:
- a BMI greater than or equal to 25 is overweight
- a BMI greater than or equal to 30 is obesity.

Missing values: very small number of missing values (34 in the whole data set)
Data accuracy: A lot of problem in this column, for example:
- Min.: 1.00
- Max.: 87.30
It's not even consistent within a country, for example in China:
- in 2013: 3.9
- In 2015: 32.9

We may need to consider dropping this column. For now, we will keep it and see if it gets selected for the model.

```{r}
investigate_missing_column_values("BMI")
```

## under-five deaths
Not sure if it's a rate for 1000 population, WHO site not clear.
```{r}
summary(life_expectancy$UnderFiveDeaths)

investigate_over1000("UnderFiveDeaths")

#India 2000-2012 Mortality rate, under-5 (per 1,000 live births) https://data.worldbank.org/indicator/SH.DYN.MORT 

#which(life_expectancy$Country == "India" & life_expectancy$Year == "2000")

life_expectancy %>% ggplot(aes(x=life_expectancy$UnderFiveDeaths))+geom_histogram()
investigate_over200('UnderFiveDeaths')

#Bangladesh- incorrect
#China- incorrect
#Democratic Republic of Congo- incorrect
#Ethiopia- incorrect
#Indonesia- incorrect
#Nigeria- incorrect
#Pakistan- incorrect

###DATA PREP: Merge Function for missing/incorrect data
# Fill incorrect UnerFiveDeaths data from secondary source: World Banks -- indicator code:  SH.DYN.MORT 
wb_under5 <- wb_data(indicator = "SH.DYN.MORT", country = "countries_only", start_date = 2000, end_date = 2015)
# Grab only necessary columns and map to match dataset
wb_under5 <- wb_under5 %>% select(date, SH.DYN.MORT , country)
colnames(wb_under5) = c("Year", "UnderFiveDeaths", "Country")

```


## Polio	
Description (from WHO): It's probably referring to "immunization coverage among one-year-olds (%)"

## Total expenditure
Description (from WHO): Total expenditure on health as a percentage of gross domestic product
200 N/A (out of almost 3,000 observations)

## Diphtheria
Description (from WHO): Diphtheria tetanus toxoid and pertussis (DTP3) immunization coverage among 1-year-olds (%)

Missing values: very small number of missing values (8 in our reduced data)
Data accuracy: minimum of 2 and maximum of 99, which makes sense given that it's a percentage. Most of the data seems to make sense with a few exception: for example, United Republic of Tanzania, where it varies widely from year to year between 9 and 98

```{r}
investigate_missing_column_values("Diphtheria")
```

## HIV/AIDS
Description: there are 23 indicators related to HIV on the WHO web site, I'm not sure which one it is
```{r}
investigate_missing_column_values("HIV_AIDS")
```

## GDP
Countries' corresponding economic data was collected from United Nation website
448 N/A (out of almost 3,000 observations)
```{r GDP Data Cleanup}
# What rows are missing GDP?
missing_GDP_indices <- which(is.na(life_expectancy[,'GDP']))
length(missing_GDP_indices)

investigate_missing_column_values("GDP")

# Fill missing GDP data from secondary source: World Banks -- indicator code:  NY.GDP.PCAP.CD
GDP_per_capita <- wb_data(indicator = "NY.GDP.PCAP.CD", country = "countries_only", start_date = 2000, end_date = 2015)
# Grab only necessary columns and map to match dataset
GDP_per_capita <- GDP_per_capita %>% select(date, NY.GDP.PCAP.CD, country)
colnames(GDP_per_capita) = c("Year", "GDP", "Country")
# Check for name discrepancies
unique(GDP_per_capita["Country"])
unique(life_expectancy["Country"])

# Country Name Corrections to match b/w GDP and Kaggle Life Expectancy dataset
GDP_per_capita[,'Country'] <- sub(", The", "", GDP_per_capita$Country)
GDP_per_capita[,"Country"] <- sub("Bolivia", "Bolivia (Plurinational State of)", GDP_per_capita$Country)
GDP_per_capita[,'Country'] <- sub("Congo, Dem. Rep.", "Congo", GDP_per_capita$Country)
GDP_per_capita[,'Country'] <- sub("Cote d'Ivoire", "Côte d'Ivoire", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Czech Republic", "Czechia", GDP_per_capita$Country) 
GDP_per_capita[,"Country"] <- sub("Democratic Republic of the Congo", "Congo", GDP_per_capita$Country)
GDP_per_capita[,'Country'] <- sub("Korea, Dem. People's Rep.", "Democratic People's Republic of Korea", GDP_per_capita$Country)
GDP_per_capita[,'Country'] <- sub("Egypt, Arab Rep.", "Egypt", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Gambia, The", "Gambia", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Iran, Islamic Rep.", "Iran (Islamic Republic of)", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Kyrgyz Republic", "Kyrgyzstan", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Lao PDR", "Lao People's Democratic Republic", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Micronesia, Fed. Sts.", "Micronesia (Federated States of)", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Korea, Rep.", "Republic of Korea", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Moldova", "Republic of Moldova", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("St. Lucia", "Saint Lucia", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("St. Vincent and the Grenadines", "Saint Vincent and the Grenadines", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Slovak Republic", "Slovakia", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Eswatini", "Swaziland", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("North Macedonia", "The former Yugoslav republic of Macedonia", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("United Kingdom", "United Kingdom of Great Britain and Northern Ireland", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Tanzania", "United Republic of Tanzania", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("United States", "United States of America", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Venezuela, RB", "Venezuela (Bolivarian Republic of)", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Vietnam", "Viet Nam", GDP_per_capita$Country) 
GDP_per_capita[,'Country'] <- sub("Yemen, Rep.", "Yemen", GDP_per_capita$Country) 

# Merge life_expectancy and GDP_per_capita on Year and Country to fill in GDP

```

## Population
700 N/A (out of almost 3,000 observations)
Min is probably wrong (population of 34?) -- Maldives 2003
```{r}
#Looking at missing values
investigate_missing_column_values("Population")
summary(life_expectancy$Population)

#investigate minimum population value: Maldives, should be 302683
min(life_expectancy[,18], na.rm=T)
which.min(life_expectancy[,18])
print(life_expectancy[1615,])

#List all missing rows
missing_pop_indices <- which(is.na(life_expectancy[,'Population']))
length(missing_pop_indices)

#Which countries do we need to import data for?
miss_pop <- life_expectancy %>% filter(is.na(life_expectancy[,'Population'])) #all missing pop data
miss_pop$Country <- as.factor(miss_pop$Country)
levels(miss_pop$Country)

#Import World Bank Population Data: https://data.worldbank.org/indicator/SP.POP.TOTL
wb_population = read.csv("data/API_SP.POP.TOTL_DS2_en_csv_v2_2445260.csv", header = FALSE)

#Tidy Data
wb_pop <- wb_population[4:66,]
colnames(wb_pop)<- wb_population[3,]
wb_pop <- wb_pop[c(1,45:60)]
wb_pop <- gather(wb_pop, Year, Population, '2000':'2015' , factor_key=TRUE)
wb_pop <- wb_pop %>% rename('Country' = 'Country Name')

#Columns that need to be renamed in order to merge (WB data is missing Cook Islands and Niue)
wb_pop[,'Country'] <- sub("Bahamas, The", "Bahamas", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Bolivia", "Bolivia (Plurinational State of)", wb_pop$Country)
wb_pop[,'Country'] <- sub("Congo, Rep.", "Congo", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Cote d'Ivoire", "Côte d'Ivoire", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Czech Republic", "Czechia", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Korea, Dem. People's Rep.", "Democratic People's Republic of Korea", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Congo, Dem. Rep.", "Democratic Republic of the Congo", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Egypt, Arab Rep.", "Egypt", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Gambia, The", "Gambia", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Iran, Islamic Rep.", "Iran (Islamic Republic of)", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Kyrgyz Republic", "Kyrgyzstan", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Lao PDR", "Lao People's Democratic Republic", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Micronesia, Fed. Sts.", "Micronesia (Federated States of)", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Korea, Rep.", "Republic of Korea", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Moldova", "Republic of Moldova", wb_pop$Country) 
wb_pop[,'Country'] <- sub("St. Kitts and Nevis", "Saint Kitts and Nevis", wb_pop$Country) 
wb_pop[,'Country'] <- sub("St. Lucia", "Saint Lucia", wb_pop$Country) 
wb_pop[,'Country'] <- sub("St. Vincent and the Grenadines", "Saint Vincent and the Grenadines", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Slovak Republic", "Slovakia", wb_pop$Country) 
wb_pop[,'Country'] <- sub("North Macedonia", "The former Yugoslav republic of Macedonia", wb_pop$Country) 
wb_pop[,'Country'] <- sub("United Kingdom", "United Kingdom of Great Britain and Northern Ireland", wb_pop$Country) 
wb_pop[,'Country'] <- sub("United States", "United States of America", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Tanzania", "United Republic of Tanzania", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Venezuela, RB", "Venezuela (Bolivarian Republic of)", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Vietnam", "Viet nam", wb_pop$Country) 
wb_pop[,'Country'] <- sub("Yemen, Rep.", "Yemen", wb_pop$Country) 


###DATA PREP: Merge Function for missing/incorrect data
# Fill mising Population data from secondary source: World Banks -- indicator code:  SP.POP.TOTL
wb_pop2 <- wb_data(indicator = "SP.POP.TOTL", country = "countries_only", start_date = 2000, end_date = 2015)
# Grab only necessary columns and map to match dataset
wb_pop2 <- wb_pop2 %>% select(date, SP.POP.TOTL , country)
colnames(wb_pop2) = c("Year", "Population", "Country")
```


## thinness  1-19 years
Description (from WHO): this could be Prevalence of thinness among children and adolescents, BMI < -2 standard deviations below the median (crude estimate) (%)
Missing Values: 34 missing values before data range restriction, 26 after (South Sudan and Sudan 2000-2009)
```{r}
investigate_missing_column_values("Thinness_1_19_years")
```


## thinness 5-9 years
Description: this could be a subset of the category above
Missing Values: 34 missing values before data range restriction, 26 after (South Sudan and Sudan 2000-2009)
```{r}
investigate_missing_column_values("Thinness_5_9_years")
```


## Income composition of resources	
United Nations Development Programme's [Human Development Index](http://hdr.undp.org/en/content/human-development-index-hdi) in terms of income composition of resources (index ranging from 0 to 1)
> The Human Development Index is a statistic composite index of life expectancy, education, and per capita income indicators, which are used to rank countries into four tiers of human development.
> `r tufte::quote_footer('--- Wikipedia')`

```{r}
# What rows are missing HDI?
missing_HDI_indices <- which(is.na(life_expectancy[,'IncomeCompositionOfResources']))
length(missing_HDI_indices)

# Are any specific year a key indicator of missing value?
life_expectancy[missing_HDI_indices,] %>% 
  group_by(Year) %>%
  summarise(missing_HDI = length(Year))
# 2000-2015 are missing are about even for missing data except 2013 has more

# What about country?
life_expectancy[missing_HDI_indices,] %>% 
  group_by(Country) %>%
  summarise(missing_HDI= length(Country))

# Year and Country Missing Entries
life_expectancy[missing_HDI_indices,c('Country','Year')]

# Import Modified CSV from UNDP as API is no longer active ()
## Original and modified are located in data, modified removes excess rows and .. values
UNDP_HDI_Bulk_Dataset <- read.csv("data/Modified_UNDP_HDI.csv",
                                  header=T,
                                  stringsAsFactors = T)
colnames(UNDP_HDI_Bulk_Dataset) <- sub("X", "", colnames(UNDP_HDI_Bulk_Dataset))
UNDP_HDI_Bulk_Dataset <- UNDP_HDI_Bulk_Dataset %>% select(-("2016":"2019") & -("1990":"1999"))

# Commenting the following for block because it's causing an error:
# Error: unexpected '}' in:
# "  life_expectancy[missing_HDI_indices[i]] <- 
# }"

# for(i in 1:length(missing_HDI_indices)) {
#   life_expectancy[missing_HDI_indices[i]] <- 
#}

```

## Schooling
Definition: Average number of completed years of education of a country's population aged 25 years and older, excluding years spent repeating individual grades.

Missing values: 10 countries are missing all the values 
Data accuracy: most of it seems accurate but there are some issues, for example Turkmenistan where is's 0 for 2000 and 2001 and 10.2 for 2002

This maybe redundant with Income composition of resources (HDI). 

```{r}
investigate_missing_column_values("Schooling")
```

#Scatterplots before data cleaning
```{r}
pairs(life_expectancy[,c(4:7)])
pairs(life_expectancy[,c(4,8:10)])
pairs(life_expectancy[,c(4,11:13)])
pairs(life_expectancy[,c(4,14:16)])
pairs(life_expectancy[,c(4,17:19)])
pairs(life_expectancy[,c(4,20:22)])
```

